(()=>{"use strict";class e{constructor(e){this.length=e,this.hitNos=0,this.sunkStat=!1}hit(){this.hitNos++}isSunk(){this.hitNos>=this.length?this.sunkStat=!0:this.sunkStat=!1}}const t=t=>{const o=new Array(10);for(let e=0;e<o.length;e++)o[e]=new Array(10).fill(0);[5,4,3,2,2].forEach((t=>{((t,o)=>{const r=new e(t),a=()=>{let e=[[Math.floor(10*Math.random()),Math.floor(10*Math.random())]],[r,s]=e[0];const n=Math.floor(4*Math.random());for(let o=1;o<t;o++)0===n&&e.push([r,--s]),1===n&&e.push([r,++s]),2===n&&e.push([++r,s]),3===n&&e.push([--r,s]);for(let t of e){const[e,r]=t;if(!(e>-1&&e<10&&r>-1&&r<10))return a();if(o[e][r])return a()}return e};a().forEach((e=>{const[t,a]=e;o[t][a]=r}))})(t,o)}));return((e,t)=>{const o=document.querySelector(".main-container"),r=document.createElement("div");r.classList.add("container"),o.append(r);for(let o=0;o<10;o++){const a=document.createElement("div");a.classList.add("box-container"),r.append(a);for(let r=0;r<10;r++){const s=document.createElement("div");s.classList.add("box"),e[r][o]?s.classList.add("ship"):s.classList.add("water"),s.dataset.x=r,s.dataset.y=o,s.dataset.player=t,a.append(s)}}})(o,t),{printBoard:()=>{console.log(o)},board:o}},o=e=>({name:e,score:0,board:t(e),playedShots:new Set}),r=e=>{const t={player1:o("p1"),player2:o("p2")},r=document.querySelector(".message"),a=document.querySelector(".win-message"),s=document.querySelector(".container").children,n=document.querySelector(".player-1-score"),l=document.querySelector(".player-2-score");let c="p2",d=t.player2.board.board,i=t.player1,y=!1,u=!1,p=0,h=0,m=!0;const S=(t,o,a)=>{if(!i.playedShots.has(`${t}${o}`)){const s=d[t][o];i.playedShots.add(`${t}${o}`),a.textContent="X",r.classList.add("animation"),m=!1,s?(setTimeout((()=>{m=!0}),3e3),s.hit(),s.isSunk(),u=!0,s.sunkStat?(i.score++,5===i.score&&(y=!0),r.textContent="its an HITT!!! The missile has hit the ship and the ship has sunk",M(i,e)):r.textContent="its an HITT!! The missile has hit the ship",q(),setTimeout((()=>{e&&"p1"===c&&x()}),5e3)):(r.textContent="The missile has hit the water.",u=!1,setTimeout((()=>{f()}),3e3)),setTimeout((()=>{r.classList.remove("animation")}),3e3),g()}},f=()=>{"p2"===c?(c="p1",d=t.player1.board.board,i=t.player2):(c="p2",d=t.player2.board.board,i=t.player1),m=!0},x=()=>{const e=(()=>{const e=()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())];return{randomMove:e,nextMove:(t,o)=>{const r=Math.floor(4*Math.random());let a=t,s=o;return 0===r&&a++,1===r&&a--,2===r&&s++,3===r&&s--,(a<0||a>9||s<0||s>9)&&([a,s]=e()),[a,s]}}})();let t,o;if(u)for([t,o]=e.nextMove(p,h);i.playedShots.has(`${t}${o}`);)[t,o]=e.randomMove();else for([t,o]=e.randomMove();i.playedShots.has(`${t}${o}`);)[t,o]=e.randomMove();p=t,h=o;let r=s.item(o).children.item(t);S(t,o,r)},q=()=>{if(y){const o=document.querySelector(".page-3"),r=document.querySelector(".page-4"),s=document.querySelector(".main-container");o.style.display="none",r.style.display="flex",t.player1.score>t.player2.score?a.textContent=e?"You WON!!! You have destroyed all the enemy ships":"Player 1 WON!!! player 2's ships were destroyed":a.textContent=e?"Computer WON!!! all your ships were destroyed":"Player 2 WON!!! player 1's ships were destroyed",s.innerHTML=""}},g=()=>{setTimeout((()=>{r.textContent="p2"===c?"Player 1's turn":e?"Computer's turn":"Player 2's turn"}),3e3)},M=(e,t)=>{"p2"===e?n.textContent=`Player 1 Score - ${e.score}`:l.textContent=t?`Computer Score - ${e.score}`:`Player 2 Score - ${e.score}`};(()=>{const t=document.querySelectorAll(".container");for(let o of t)o.addEventListener("click",(t=>{if(m){const o=t.target.dataset.player,r=parseInt(t.target.dataset.x),a=parseInt(t.target.dataset.y);e?"p2"===o&&(S(r,a,t.target),setTimeout((()=>{"p1"===c&&x()}),5e3)):o===c&&S(r,a,t.target)}}))})()},a=document.querySelector(".start-btn"),s=document.querySelector(".page-1"),n=document.querySelector(".page-2"),l=document.querySelector(".page-3"),c=document.querySelector(".page-4"),d=document.querySelectorAll(".choose-player"),i=document.querySelector(".play-again");a.addEventListener("click",(()=>{s.style.display="none",n.style.display="flex"})),d.forEach((e=>{e.addEventListener("click",(()=>{n.style.display="none",l.style.display="flex";const t=parseInt(e.dataset.play);r(t)}))})),i.addEventListener("click",(()=>{const e=document.querySelector(".player-1-score"),t=document.querySelector(".player-2-score");c.style.display="none",s.style.display="flex",document.querySelector(".message").textContent="",e.textContent="Player 1 Score - 0",t.textContent="Player 2 Score - 0"}))})();